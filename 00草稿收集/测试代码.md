<%*
// ===== å·¥å…·å‡½æ•° =====
Function è·å–å½“å‰æ—¥æœŸ () {
  Const æ–‡ä»¶å = tp. File. Title;
  Const æ—¥æœŸåŒ¹é… = æ–‡ä»¶å.Match (/(\d{4})-? (\d{2})-? (\d{2})/);
  Return æ—¥æœŸåŒ¹é… ? New Date (`${æ—¥æœŸåŒ¹é…[1]}-${æ—¥æœŸåŒ¹é…[2]}-${æ—¥æœŸåŒ¹é…[3]}`) : new Date ();
}

Function ç”Ÿæˆè¿›åº¦æ¡ (ç™¾åˆ†æ¯”, é•¿åº¦=20) {
  Const å‰©ä½™æ¯”ä¾‹ = 100 - ç™¾åˆ†æ¯”;
  Const å‰©ä½™æ ¼å­ = Math.Floor (å‰©ä½™æ¯”ä¾‹/100 * é•¿åº¦);
  
  // çº¢ç»¿ç¯ä¸‰è‰²ï¼š
  Const é¢œè‰² = 
    å‰©ä½™æ¯”ä¾‹ > 60 ? " #4CAF50 " :  // ç»¿ï¼ˆå®‰å…¨ï¼‰
    å‰©ä½™æ¯”ä¾‹ > 30 ? " #FFC107 " :  // é»„ï¼ˆè­¦å‘Šï¼‰
    " #F44336 ";                   // çº¢ï¼ˆå±é™©ï¼‰

  return `â”‚<span style="color:#E0E0E0">${"â–‘".Repeat (é•¿åº¦ - å‰©ä½™æ ¼å­)}</span>` +
         `<span style="color:${é¢œè‰²}">${"â–ˆ".Repeat (å‰©ä½™æ ¼å­)}</span>â”‚`;
}

// ===== ä¸»è®¡ç®—é€»è¾‘ =====
Const å½“å‰æ—¥æœŸ = è·å–å½“å‰æ—¥æœŸ ();
Const å½“å‰å¹´ä»½ = å½“å‰æ—¥æœŸ.GetFullYear ();

// 1. å¹´è¿›åº¦
Const å¹´åˆ = new Date (å½“å‰å¹´ä»½, 0, 1);
Const å¹´æœ« = new Date (å½“å‰å¹´ä»½, 11, 31);
Const å…¨å¹´å¤©æ•° = Math.Floor ((å¹´æœ« - å¹´åˆ) / 86400000 + 1);
Const å·²è¿‡å¤©æ•° = Math.Floor ((å½“å‰æ—¥æœŸ - å¹´åˆ) / 86400000 + 1);
Const å‰©ä½™å¤©æ•° = å…¨å¹´å¤©æ•° - å·²è¿‡å¤©æ•°;

// 2. æœˆè¿›åº¦
Const å½“æœˆå¤©æ•° = new Date (å½“å‰å¹´ä»½, å½“å‰æ—¥æœŸ.GetMonth () + 1, 0). GetDate ();
Const å·²è¿‡å½“æœˆå¤©æ•° = å½“å‰æ—¥æœŸ.GetDate ();
Const å‰©ä½™å½“æœˆå¤©æ•° = å½“æœˆå¤©æ•° - å·²è¿‡å½“æœˆå¤©æ•°;

// 3. å‘¨è¿›åº¦
Const æœ¬å‘¨ç¬¬å‡ å¤© = å½“å‰æ—¥æœŸ.GetDay (); // 0=å‘¨æ—¥
Const å·²è¿‡å‘¨å¤©æ•° = æœ¬å‘¨ç¬¬å‡ å¤© === 0 ? 7 : æœ¬å‘¨ç¬¬å‡ å¤©; // å‘¨ä¸€ä¸º 1 â†’ å‘¨æ—¥ä¸º 7
Const å‰©ä½™å‘¨å¤©æ•° = 7 - å·²è¿‡å‘¨å¤©æ•°;

// ===== è¾“å‡ºç»“æœ =====
TR += `
## ğŸ•°ï¸ æ—¶é—´è¿›åº¦ä»ªè¡¨ç›˜
| å‘¨æœŸ  |     è¿›åº¦ç™¾åˆ†æ¯”       | â³ è¿›åº¦æ¡  | å·²è¿‡æ—¶é—´ | å‰©ä½™æ—¶é—´ | æ€»æ—¶é•¿  |
|-------|-------------------|-------------|----------|----------|---------|
| â˜€ï¸ å¹´ | ${(å·²è¿‡å¤©æ•°/å…¨å¹´å¤©æ•°*100). ToFixed (1)}%  | ${ç”Ÿæˆè¿›åº¦æ¡ (å·²è¿‡å¤©æ•°/å…¨å¹´å¤©æ•°*100)}| ${å·²è¿‡å¤©æ•°}å¤© | ${å‰©ä½™å¤©æ•°}å¤© | ${å…¨å¹´å¤©æ•°}å¤© |
| ğŸŒ™ æœˆ | ${(å·²è¿‡å½“æœˆå¤©æ•°/å½“æœˆå¤©æ•°*100). ToFixed (1)}%  | ${ç”Ÿæˆè¿›åº¦æ¡ (å·²è¿‡å½“æœˆå¤©æ•°/å½“æœˆå¤©æ•°*100)} | ${å·²è¿‡å½“æœˆå¤©æ•°}å¤© | ${å‰©ä½™å½“æœˆå¤©æ•°}å¤© | ${å½“æœˆå¤©æ•°}å¤© |
| â­ å‘¨ | ${(å·²è¿‡å‘¨å¤©æ•°/7*100). ToFixed (1)}%  | ${ç”Ÿæˆè¿›åº¦æ¡ (å·²è¿‡å‘¨å¤©æ•°/7*100)} | ${å·²è¿‡å‘¨å¤©æ•°}å¤© | ${å‰©ä½™å‘¨å¤©æ•°}å¤© | 7 å¤© |
`;
%>
