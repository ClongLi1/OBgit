```dataviewjs
// ===== 工具函数 =====
function 获取当前日期() {
    return new Date();
}

function 生成进度条(百分比, 长度 = 20) {
    const 完成格子数 = Math.floor(百分比 / 100 * 长度);
    const 剩余格子 = 长度 - 完成格子数;
    
    // 红绿灯三色：
    const 颜色 = 
        百分比 > 70 ? "#F44336" :  // 红（危险）
        百分比 > 40 ? "#FFC107" :  // 黄（警告）
        "#4CAF50";                // 绿（安全）

    return  `<span style="color:#E0E0E0">${"█".repeat(完成格子数)}</span>`+
           `<span style="color:${颜色}">${"█".repeat(剩余格子)}</span>`;
}

// ===== 主计算逻辑 =====
const 当前日期 = 获取当前日期();
const 当前年份 = 当前日期.getFullYear();

// 1. 年进度
const 年初 = new Date(当前年份, 0, 1);
const 年末 = new Date(当前年份, 11, 31);
const 全年天数 = Math.floor((年末 - 年初) / 86400000) + 1;
const 已过天数 = Math.floor((当前日期 - 年初) / 86400000) + 1;
const 年进度百分比 = (已过天数 / 全年天数 * 100).toFixed(1);
const 剩余天数 = 全年天数 - 已过天数;

// 2. 月进度
const 当月天数 = new Date(当前年份, 当前日期.getMonth() + 1, 0).getDate();
const 已过当月天数 = 当前日期.getDate();
const 月进度百分比 = (已过当月天数 / 当月天数 * 100).toFixed(1);
const 剩余当月天数 = 当月天数 - 已过当月天数;

// 3. 周进度
const 本周第几天 = 当前日期.getDay(); // 0=周日
const 已过周天数 = 本周第几天 === 0 ? 6 : 本周第几天 - 1; // 周一为0 → 周日为6
const 周进度百分比 = ((已过周天数 + 1) / 7 * 100).toFixed(1); // +1 因为当天也算已过
const 剩余周天数 = 6 - 已过周天数;

// ===== 输出结果 =====
dv.span(`
## 🕰️ 时间进度仪表盘
| 周期  | 进度百分比 | 进度条                  | 已过时间     | 剩余时间     | 总时长    |
|-------|------------|-------------------------|--------------|--------------|-----------|
| ⭐ 周 | ${周进度百分比}%  | ${生成进度条(周进度百分比)} | ${已过周天数+1}天  | ${剩余周天数}天  | 7天       |
| 🌙 月 | ${月进度百分比}%  | ${生成进度条(月进度百分比)} | ${已过当月天数}天 | ${剩余当月天数}天 | ${当月天数}天  |
| 🌞 年 | ${年进度百分比}%  | ${生成进度条(年进度百分比)} | ${已过天数}天  | ${剩余天数}天  | ${全年天数}天 |
`);
```
